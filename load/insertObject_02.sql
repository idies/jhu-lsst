USE [LSST_02]
GO

INSERT INTO [dbo].[Object_02] with (tablockx)
           ([deepSourceId]
           ,[ra]
           ,[decl]
           ,[raVar]
           ,[declVar]
           ,[radeclCov]
           ,[htmID]
           ,[chunkId]
           ,[subChunkId]
           ,[u_psfFlux]
           ,[u_psfFluxSigma]
           ,[u_apFlux]
           ,[u_apFluxSigma]
           ,[u_modelFlux]
           ,[u_modelFluxSigma]
           ,[u_instFlux]
           ,[u_instFluxSigma]
           ,[u_apCorrection]
           ,[u_apCorrectionSigma]
           ,[u_shapeIx]
           ,[u_shapeIy]
           ,[u_shapeIxVar]
           ,[u_shapeIyVar]
           ,[u_shapeIxIyCov]
           ,[u_shapeIxx]
           ,[u_shapeIyy]
           ,[u_shapeIxy]
           ,[u_shapeIxxVar]
           ,[u_shapeIyyVar]
           ,[u_shapeIxyVar]
           ,[u_shapeIxxIyyCov]
           ,[u_shapeIxxIxyCov]
           ,[u_shapeIyyIxyCov]
           ,[u_extendedness]
           ,[u_flagNegative]
           ,[u_flagBadMeasCentroid]
           ,[u_flagPixEdge]
           ,[u_flagPixInterpAny]
           ,[u_flagPixInterpCen]
           ,[u_flagPixSaturAny]
           ,[u_flagPixSaturCen]
           ,[u_flagBadPsfFlux]
           ,[u_flagBadApFlux]
           ,[u_flagBadModelFlux]
           ,[u_flagBadInstFlux]
           ,[u_flagBadCentroid]
           ,[u_flagBadShape]
           ,[g_psfFlux]
           ,[g_psfFluxSigma]
           ,[g_apFlux]
           ,[g_apFluxSigma]
           ,[g_modelFlux]
           ,[g_modelFluxSigma]
           ,[g_instFlux]
           ,[g_instFluxSigma]
           ,[g_apCorrection]
           ,[g_apCorrectionSigma]
           ,[g_shapeIx]
           ,[g_shapeIy]
           ,[g_shapeIxVar]
           ,[g_shapeIyVar]
           ,[g_shapeIxIyCov]
           ,[g_shapeIxx]
           ,[g_shapeIyy]
           ,[g_shapeIxy]
           ,[g_shapeIxxVar]
           ,[g_shapeIyyVar]
           ,[g_shapeIxyVar]
           ,[g_shapeIxxIyyCov]
           ,[g_shapeIxxIxyCov]
           ,[g_shapeIyyIxyCov]
           ,[g_extendedness]
           ,[g_flagNegative]
           ,[g_flagBadMeasCentroid]
           ,[g_flagPixEdge]
           ,[g_flagPixInterpAny]
           ,[g_flagPixInterpCen]
           ,[g_flagPixSaturAny]
           ,[g_flagPixSaturCen]
           ,[g_flagBadPsfFlux]
           ,[g_flagBadApFlux]
           ,[g_flagBadModelFlux]
           ,[g_flagBadInstFlux]
           ,[g_flagBadCentroid]
           ,[g_flagBadShape]
           ,[r_psfFlux]
           ,[r_psfFluxSigma]
           ,[r_apFlux]
           ,[r_apFluxSigma]
           ,[r_modelFlux]
           ,[r_modelFluxSigma]
           ,[r_instFlux]
           ,[r_instFluxSigma]
           ,[r_apCorrection]
           ,[r_apCorrectionSigma]
           ,[r_shapeIx]
           ,[r_shapeIy]
           ,[r_shapeIxVar]
           ,[r_shapeIyVar]
           ,[r_shapeIxIyCov]
           ,[r_shapeIxx]
           ,[r_shapeIyy]
           ,[r_shapeIxy]
           ,[r_shapeIxxVar]
           ,[r_shapeIyyVar]
           ,[r_shapeIxyVar]
           ,[r_shapeIxxIyyCov]
           ,[r_shapeIxxIxyCov]
           ,[r_shapeIyyIxyCov]
           ,[r_extendedness]
           ,[r_flagNegative]
           ,[r_flagBadMeasCentroid]
           ,[r_flagPixEdge]
           ,[r_flagPixInterpAny]
           ,[r_flagPixInterpCen]
           ,[r_flagPixSaturAny]
           ,[r_flagPixSaturCen]
           ,[r_flagBadPsfFlux]
           ,[r_flagBadApFlux]
           ,[r_flagBadModelFlux]
           ,[r_flagBadInstFlux]
           ,[r_flagBadCentroid]
           ,[r_flagBadShape]
           ,[i_psfFlux]
           ,[i_psfFluxSigma]
           ,[i_apFlux]
           ,[i_apFluxSigma]
           ,[i_modelFlux]
           ,[i_modelFluxSigma]
           ,[i_instFlux]
           ,[i_instFluxSigma]
           ,[i_apCorrection]
           ,[i_apCorrectionSigma]
           ,[i_shapeIx]
           ,[i_shapeIy]
           ,[i_shapeIxVar]
           ,[i_shapeIyVar]
           ,[i_shapeIxIyCov]
           ,[i_shapeIxx]
           ,[i_shapeIyy]
           ,[i_shapeIxy]
           ,[i_shapeIxxVar]
           ,[i_shapeIyyVar]
           ,[i_shapeIxyVar]
           ,[i_shapeIxxIyyCov]
           ,[i_shapeIxxIxyCov]
           ,[i_shapeIyyIxyCov]
           ,[i_extendedness]
           ,[i_flagNegative]
           ,[i_flagBadMeasCentroid]
           ,[i_flagPixEdge]
           ,[i_flagPixInterpAny]
           ,[i_flagPixInterpCen]
           ,[i_flagPixSaturAny]
           ,[i_flagPixSaturCen]
           ,[i_flagBadPsfFlux]
           ,[i_flagBadApFlux]
           ,[i_flagBadModelFlux]
           ,[i_flagBadInstFlux]
           ,[i_flagBadCentroid]
           ,[i_flagBadShape]
           ,[z_psfFlux]
           ,[z_psfFluxSigma]
           ,[z_apFlux]
           ,[z_apFluxSigma]
           ,[z_modelFlux]
           ,[z_modelFluxSigma]
           ,[z_instFlux]
           ,[z_instFluxSigma]
           ,[z_apCorrection]
           ,[z_apCorrectionSigma]
           ,[z_shapeIx]
           ,[z_shapeIy]
           ,[z_shapeIxVar]
           ,[z_shapeIyVar]
           ,[z_shapeIxIyCov]
           ,[z_shapeIxx]
           ,[z_shapeIyy]
           ,[z_shapeIxy]
           ,[z_shapeIxxVar]
           ,[z_shapeIyyVar]
           ,[z_shapeIxyVar]
           ,[z_shapeIxxIyyCov]
           ,[z_shapeIxxIxyCov]
           ,[z_shapeIyyIxyCov]
           ,[z_extendedness]
           ,[z_flagNegative]
           ,[z_flagBadMeasCentroid]
           ,[z_flagPixEdge]
           ,[z_flagPixInterpAny]
           ,[z_flagPixInterpCen]
           ,[z_flagPixSaturAny]
           ,[z_flagPixSaturCen]
           ,[z_flagBadPsfFlux]
           ,[z_flagBadApFlux]
           ,[z_flagBadModelFlux]
           ,[z_flagBadInstFlux]
           ,[z_flagBadCentroid]
           ,[z_flagBadShape]
           ,[y_psfFlux]
           ,[y_psfFluxSigma]
           ,[y_apFlux]
           ,[y_apFluxSigma]
           ,[y_modelFlux]
           ,[y_modelFluxSigma]
           ,[y_instFlux]
           ,[y_instFluxSigma]
           ,[y_apCorrection]
           ,[y_apCorrectionSigma]
           ,[y_shapeIx]
           ,[y_shapeIy]
           ,[y_shapeIxVar]
           ,[y_shapeIyVar]
           ,[y_shapeIxIyCov]
           ,[y_shapeIxx]
           ,[y_shapeIyy]
           ,[y_shapeIxy]
           ,[y_shapeIxxVar]
           ,[y_shapeIyyVar]
           ,[y_shapeIxyVar]
           ,[y_shapeIxxIyyCov]
           ,[y_shapeIxxIxyCov]
           ,[y_shapeIyyIxyCov]
           ,[y_extendedness]
           ,[y_flagNegative]
           ,[y_flagBadMeasCentroid]
           ,[y_flagPixEdge]
           ,[y_flagPixInterpAny]
           ,[y_flagPixInterpCen]
           ,[y_flagPixSaturAny]
           ,[y_flagPixSaturCen]
           ,[y_flagBadPsfFlux]
           ,[y_flagBadApFlux]
           ,[y_flagBadModelFlux]
           ,[y_flagBadInstFlux]
           ,[y_flagBadCentroid]
           ,[y_flagBadShape])  
    SELECT [deepSourceId]
      ,[ra]
      ,[decl]
      ,[raVar]
      ,[declVar]
      ,[radeclCov]
	  ,LSST20.htmid.fromEq(ra, decl)
      ,[chunkId]
      ,[subChunkId]
	  ,[u_psfFlux]
      ,[u_psfFluxSigma]
      ,[u_apFlux]
      ,[u_apFluxSigma]
      ,[u_modelFlux]
      ,[u_modelFluxSigma]
      ,[u_instFlux]
      ,[u_instFluxSigma]
      ,[u_apCorrection]
      ,[u_apCorrectionSigma]
      ,[u_shapeIx]
      ,[u_shapeIy]
      ,[u_shapeIxVar]
      ,[u_shapeIyVar]
      ,[u_shapeIxIyCov]
      ,[u_shapeIxx]
      ,[u_shapeIyy]
      ,[u_shapeIxy]
      ,[u_shapeIxxVar]
      ,[u_shapeIyyVar]
      ,[u_shapeIxyVar]
      ,[u_shapeIxxIyyCov]
      ,[u_shapeIxxIxyCov]
      ,[u_shapeIyyIxyCov]
      ,[u_extendedness]
      ,[u_flagNegative]
      ,[u_flagBadMeasCentroid]
      ,[u_flagPixEdge]
      ,[u_flagPixInterpAny]
      ,[u_flagPixInterpCen]
      ,[u_flagPixSaturAny]
      ,[u_flagPixSaturCen]
      ,[u_flagBadPsfFlux]
      ,[u_flagBadApFlux]
      ,[u_flagBadModelFlux]
      ,[u_flagBadInstFlux]
      ,[u_flagBadCentroid]
      ,[u_flagBadShape]
      ,[g_psfFlux]
      ,[g_psfFluxSigma]
      ,[g_apFlux]
      ,[g_apFluxSigma]
      ,[g_modelFlux]
      ,[g_modelFluxSigma]
      ,[g_instFlux]
      ,[g_instFluxSigma]
      ,[g_apCorrection]
      ,[g_apCorrectionSigma]
      ,[g_shapeIx]
      ,[g_shapeIy]
      ,[g_shapeIxVar]
      ,[g_shapeIyVar]
      ,[g_shapeIxIyCov]
      ,[g_shapeIxx]
      ,[g_shapeIyy]
      ,[g_shapeIxy]
      ,[g_shapeIxxVar]
      ,[g_shapeIyyVar]
      ,[g_shapeIxyVar]
      ,[g_shapeIxxIyyCov]
      ,[g_shapeIxxIxyCov]
      ,[g_shapeIyyIxyCov]
      ,[g_extendedness]
      ,[g_flagNegative]
      ,[g_flagBadMeasCentroid]
      ,[g_flagPixEdge]
      ,[g_flagPixInterpAny]
      ,[g_flagPixInterpCen]
      ,[g_flagPixSaturAny]
      ,[g_flagPixSaturCen]
      ,[g_flagBadPsfFlux]
      ,[g_flagBadApFlux]
      ,[g_flagBadModelFlux]
      ,[g_flagBadInstFlux]
      ,[g_flagBadCentroid]
      ,[g_flagBadShape]
      ,[r_psfFlux]
      ,[r_psfFluxSigma]
      ,[r_apFlux]
      ,[r_apFluxSigma]
      ,[r_modelFlux]
      ,[r_modelFluxSigma]
      ,[r_instFlux]
      ,[r_instFluxSigma]
      ,[r_apCorrection]
      ,[r_apCorrectionSigma]
      ,[r_shapeIx]
      ,[r_shapeIy]
      ,[r_shapeIxVar]
      ,[r_shapeIyVar]
      ,[r_shapeIxIyCov]
      ,[r_shapeIxx]
      ,[r_shapeIyy]
      ,[r_shapeIxy]
      ,[r_shapeIxxVar]
      ,[r_shapeIyyVar]
      ,[r_shapeIxyVar]
      ,[r_shapeIxxIyyCov]
      ,[r_shapeIxxIxyCov]
      ,[r_shapeIyyIxyCov]
      ,[r_extendedness]
      ,[r_flagNegative]
      ,[r_flagBadMeasCentroid]
      ,[r_flagPixEdge]
      ,[r_flagPixInterpAny]
      ,[r_flagPixInterpCen]
      ,[r_flagPixSaturAny]
      ,[r_flagPixSaturCen]
      ,[r_flagBadPsfFlux]
      ,[r_flagBadApFlux]
      ,[r_flagBadModelFlux]
      ,[r_flagBadInstFlux]
      ,[r_flagBadCentroid]
      ,[r_flagBadShape]
      ,[i_psfFlux]
      ,[i_psfFluxSigma]
      ,[i_apFlux]
      ,[i_apFluxSigma]
      ,[i_modelFlux]
      ,[i_modelFluxSigma]
      ,[i_instFlux]
      ,[i_instFluxSigma]
      ,[i_apCorrection]
      ,[i_apCorrectionSigma]
      ,[i_shapeIx]
      ,[i_shapeIy]
      ,[i_shapeIxVar]
      ,[i_shapeIyVar]
      ,[i_shapeIxIyCov]
      ,[i_shapeIxx]
      ,[i_shapeIyy]
      ,[i_shapeIxy]
      ,[i_shapeIxxVar]
      ,[i_shapeIyyVar]
      ,[i_shapeIxyVar]
      ,[i_shapeIxxIyyCov]
      ,[i_shapeIxxIxyCov]
      ,[i_shapeIyyIxyCov]
      ,[i_extendedness]
      ,[i_flagNegative]
      ,[i_flagBadMeasCentroid]
      ,[i_flagPixEdge]
      ,[i_flagPixInterpAny]
      ,[i_flagPixInterpCen]
      ,[i_flagPixSaturAny]
      ,[i_flagPixSaturCen]
      ,[i_flagBadPsfFlux]
      ,[i_flagBadApFlux]
      ,[i_flagBadModelFlux]
      ,[i_flagBadInstFlux]
      ,[i_flagBadCentroid]
      ,[i_flagBadShape]
      ,[z_psfFlux]
      ,[z_psfFluxSigma]
      ,[z_apFlux]
      ,[z_apFluxSigma]
      ,[z_modelFlux]
      ,[z_modelFluxSigma]
      ,[z_instFlux]
      ,[z_instFluxSigma]
      ,[z_apCorrection]
      ,[z_apCorrectionSigma]
      ,[z_shapeIx]
      ,[z_shapeIy]
      ,[z_shapeIxVar]
      ,[z_shapeIyVar]
      ,[z_shapeIxIyCov]
      ,[z_shapeIxx]
      ,[z_shapeIyy]
      ,[z_shapeIxy]
      ,[z_shapeIxxVar]
      ,[z_shapeIyyVar]
      ,[z_shapeIxyVar]
      ,[z_shapeIxxIyyCov]
      ,[z_shapeIxxIxyCov]
      ,[z_shapeIyyIxyCov]
      ,[z_extendedness]
      ,[z_flagNegative]
      ,[z_flagBadMeasCentroid]
      ,[z_flagPixEdge]
      ,[z_flagPixInterpAny]
      ,[z_flagPixInterpCen]
      ,[z_flagPixSaturAny]
      ,[z_flagPixSaturCen]
      ,[z_flagBadPsfFlux]
      ,[z_flagBadApFlux]
      ,[z_flagBadModelFlux]
      ,[z_flagBadInstFlux]
      ,[z_flagBadCentroid]
      ,[z_flagBadShape]
      ,[y_psfFlux]
      ,[y_psfFluxSigma]
      ,[y_apFlux]
      ,[y_apFluxSigma]
      ,[y_modelFlux]
      ,[y_modelFluxSigma]
      ,[y_instFlux]
      ,[y_instFluxSigma]
      ,[y_apCorrection]
      ,[y_apCorrectionSigma]
      ,[y_shapeIx]
      ,[y_shapeIy]
      ,[y_shapeIxVar]
      ,[y_shapeIyVar]
      ,[y_shapeIxIyCov]
      ,[y_shapeIxx]
      ,[y_shapeIyy]
      ,[y_shapeIxy]
      ,[y_shapeIxxVar]
      ,[y_shapeIyyVar]
      ,[y_shapeIxyVar]
      ,[y_shapeIxxIyyCov]
      ,[y_shapeIxxIxyCov]
      ,[y_shapeIyyIxyCov]
      ,[y_extendedness]
      ,[y_flagNegative]
      ,[y_flagBadMeasCentroid]
      ,[y_flagPixEdge]
      ,[y_flagPixInterpAny]
      ,[y_flagPixInterpCen]
      ,[y_flagPixSaturAny]
      ,[y_flagPixSaturCen]
      ,[y_flagBadPsfFlux]
      ,[y_flagBadApFlux]
      ,[y_flagBadModelFlux]
      ,[y_flagBadInstFlux]
      ,[y_flagBadCentroid]
      ,[y_flagBadShape]
  FROM [lsst_stage].[dbo].[object_stage]
  with (nolock)
GO


